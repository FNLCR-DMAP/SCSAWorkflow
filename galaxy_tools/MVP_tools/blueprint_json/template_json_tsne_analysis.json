{
  "rid": "ri.vector.main.template.5482694a-f3af-412e-a2e3-728259247661",
  "title": "tSNE Analysis [SPAC] [DMAP]",
  "description": "Perform t-SNE dimensionality reduction using a specific table. Will add the annotation \"<Table to Process>_tsne\" to the analysis\\\nPlease refer to [DUET Documentation](https://nidap.nih.gov/shares/links/lpvog4y6vrmfk),  [GitHub Documentation](https://fnlcr-dmap.github.io/SCSAWorkflow/spac.html#spac.transformations.tsne)",
  "createdBy": "2fdfc0bf-b680-4054-9cbc-2814fb01f8a4",
  "createdAt": "2024-09-05T13:03:19.313155845Z",
  "commitMessage": "spac v0.7.0",
  "status": "RELEASED",
  "inputDatasets": [
    {
      "key": "Upstream_Analysis",
      "displayName": "Upstream Analysis",
      "description": "Link to prior processed dataset in the analysis.",
      "paramGroup": null,
      "anchorDataset": null,
      "dataType": "PYTHON_TRANSFORM_INPUT",
      "tags": []
    }
  ],
  "parameters": [
    {
      "key": "Table_to_Process",
      "displayName": "Table to Process",
      "description": "Source table to perform the computation.  Default is Original, referring to the raw features (markers).",
      "paramType": "STRING",
      "paramGroup": null,
      "paramValues": null,
      "defaultValue": "Original",
      "condition": null,
      "content": null,
      "objectPropertyReference": null
    }
  ],
  "columns": [],
  "orderedMustacheKeys": [
    "Upstream_Analysis",
    "Table_to_Process"
  ],
  "contents": {
    "type": "code",
    "code": {
      "codeLanguage": "PYTHON",
      "codeTemplate": "def tsne_analysis({{{Upstream_Analysis}}}):\n\n    ## --------- ##\n    ## Libraries ##\n    ## --------- ##\n\n    from spac.transformations import tsne\n    import pickle\n\n    ## -------------------------------- ##\n    ## User-Defined Template Parameters ##\n    ## -------------------------------- ##\n\n    NIDAP_dataset = {{{Upstream_Analysis}}}.filesystem()\n    with NIDAP_dataset.open(\"transform_output.pickle\", \"rb\") as input_file:\n        all_data = pickle.load(input_file) \n\n    # Select layer to perform tSNHE\n    Layer_to_Analysis = \"{{{Table_to_Process}}}\"\n\n\n    ##--------------- ##\n    ## Error Messages ##\n    ## -------------- ##\n\n\n\n    ## --------- ##\n    ## Functions ##\n    ## --------- ##\n\n\n\n    ## --------------- ##\n    ## Main Code Block ##\n    ## --------------- ##\n\n    print(all_data)\n    if Layer_to_Analysis == \"Original\":\n        Layer_to_Analysis = None\n\n    print(\"tSNE Layer: \\n\", Layer_to_Analysis)\n\n    print(\"Performing tSNE ...\")\n    \n    tsne(all_data, layer = Layer_to_Analysis)\n\n    print(\"tSNE Done!\")\n    \n    print(all_data)\n\n    object_to_output = all_data\n    output = Transforms.get_output()\n    output_fs = output.filesystem()\n    with output_fs.open('transform_output.pickle', 'wb') as f:\n        pickle.dump(object_to_output, f)\n    return(None)\n",
      "shouldPersist": true
    }
  },
  "version": 5,
  "externalId": null,
  "canEditTemplate": true,
  "path": "/NIDAP/NCI-Wide Analysis & Visualization Resources/SPAC/SPAC Templates/tSNE Analysis [SPAC] [DMAP]",
  "tags": [
    {
      "rid": "ri.compass.main.tag.02094a7d-d869-4dff-bc31-78ad8676d1ad",
      "name": "Code Templates:DMAP"
    },
    {
      "rid": "ri.compass.main.tag.ebb2ab0f-e354-4bd4-9f3a-e78dc8452986",
      "name": "Code Templates:SPAC"
    }
  ],
  "favorite": false,
  "namedCollections": [],
  "isDefault": true,
  "condaDependencies": [
    "python=3.6"
  ],
  "outputDatasetName": "tsne_analysis",
  "outputs": {
    "analysis": {"type": "file", "name": "output.pickle"}
  }
}